{
  "version": 3,
  "sources": ["../../set-cookie-parser/lib/set-cookie.js", "../../@keystatic/core/dist/keystatic-core-api-generic.js", "../../@keystatic/astro/dist/keystatic-astro-api.js"],
  "sourcesContent": ["\"use strict\";\n\nvar defaultParseOptions = {\n  decodeValues: true,\n  map: false,\n  silent: false,\n};\n\nfunction isNonEmptyString(str) {\n  return typeof str === \"string\" && !!str.trim();\n}\n\nfunction parseString(setCookieValue, options) {\n  var parts = setCookieValue.split(\";\").filter(isNonEmptyString);\n\n  var nameValuePairStr = parts.shift();\n  var parsed = parseNameValuePair(nameValuePairStr);\n  var name = parsed.name;\n  var value = parsed.value;\n\n  options = options\n    ? Object.assign({}, defaultParseOptions, options)\n    : defaultParseOptions;\n\n  try {\n    value = options.decodeValues ? decodeURIComponent(value) : value; // decode cookie value\n  } catch (e) {\n    console.error(\n      \"set-cookie-parser encountered an error while decoding a cookie with value '\" +\n        value +\n        \"'. Set options.decodeValues to false to disable this feature.\",\n      e\n    );\n  }\n\n  var cookie = {\n    name: name,\n    value: value,\n  };\n\n  parts.forEach(function (part) {\n    var sides = part.split(\"=\");\n    var key = sides.shift().trimLeft().toLowerCase();\n    var value = sides.join(\"=\");\n    if (key === \"expires\") {\n      cookie.expires = new Date(value);\n    } else if (key === \"max-age\") {\n      cookie.maxAge = parseInt(value, 10);\n    } else if (key === \"secure\") {\n      cookie.secure = true;\n    } else if (key === \"httponly\") {\n      cookie.httpOnly = true;\n    } else if (key === \"samesite\") {\n      cookie.sameSite = value;\n    } else {\n      cookie[key] = value;\n    }\n  });\n\n  return cookie;\n}\n\nfunction parseNameValuePair(nameValuePairStr) {\n  // Parses name-value-pair according to rfc6265bis draft\n\n  var name = \"\";\n  var value = \"\";\n  var nameValueArr = nameValuePairStr.split(\"=\");\n  if (nameValueArr.length > 1) {\n    name = nameValueArr.shift();\n    value = nameValueArr.join(\"=\"); // everything after the first =, joined by a \"=\" if there was more than one part\n  } else {\n    value = nameValuePairStr;\n  }\n\n  return { name: name, value: value };\n}\n\nfunction parse(input, options) {\n  options = options\n    ? Object.assign({}, defaultParseOptions, options)\n    : defaultParseOptions;\n\n  if (!input) {\n    if (!options.map) {\n      return [];\n    } else {\n      return {};\n    }\n  }\n\n  if (input.headers) {\n    if (typeof input.headers.getSetCookie === \"function\") {\n      // for fetch responses - they combine headers of the same type in the headers array,\n      // but getSetCookie returns an uncombined array\n      input = input.headers.getSetCookie();\n    } else if (input.headers[\"set-cookie\"]) {\n      // fast-path for node.js (which automatically normalizes header names to lower-case\n      input = input.headers[\"set-cookie\"];\n    } else {\n      // slow-path for other environments - see #25\n      var sch =\n        input.headers[\n          Object.keys(input.headers).find(function (key) {\n            return key.toLowerCase() === \"set-cookie\";\n          })\n        ];\n      // warn if called on a request-like object with a cookie header rather than a set-cookie header - see #34, 36\n      if (!sch && input.headers.cookie && !options.silent) {\n        console.warn(\n          \"Warning: set-cookie-parser appears to have been called on a request object. It is designed to parse Set-Cookie headers from responses, not Cookie headers from requests. Set the option {silent: true} to suppress this warning.\"\n        );\n      }\n      input = sch;\n    }\n  }\n  if (!Array.isArray(input)) {\n    input = [input];\n  }\n\n  options = options\n    ? Object.assign({}, defaultParseOptions, options)\n    : defaultParseOptions;\n\n  if (!options.map) {\n    return input.filter(isNonEmptyString).map(function (str) {\n      return parseString(str, options);\n    });\n  } else {\n    var cookies = {};\n    return input.filter(isNonEmptyString).reduce(function (cookies, str) {\n      var cookie = parseString(str, options);\n      cookies[cookie.name] = cookie;\n      return cookies;\n    }, cookies);\n  }\n}\n\n/*\n  Set-Cookie header field-values are sometimes comma joined in one string. This splits them without choking on commas\n  that are within a single set-cookie field-value, such as in the Expires portion.\n\n  This is uncommon, but explicitly allowed - see https://tools.ietf.org/html/rfc2616#section-4.2\n  Node.js does this for every header *except* set-cookie - see https://github.com/nodejs/node/blob/d5e363b77ebaf1caf67cd7528224b651c86815c1/lib/_http_incoming.js#L128\n  React Native's fetch does this for *every* header, including set-cookie.\n\n  Based on: https://github.com/google/j2objc/commit/16820fdbc8f76ca0c33472810ce0cb03d20efe25\n  Credits to: https://github.com/tomball for original and https://github.com/chrusart for JavaScript implementation\n*/\nfunction splitCookiesString(cookiesString) {\n  if (Array.isArray(cookiesString)) {\n    return cookiesString;\n  }\n  if (typeof cookiesString !== \"string\") {\n    return [];\n  }\n\n  var cookiesStrings = [];\n  var pos = 0;\n  var start;\n  var ch;\n  var lastComma;\n  var nextStart;\n  var cookiesSeparatorFound;\n\n  function skipWhitespace() {\n    while (pos < cookiesString.length && /\\s/.test(cookiesString.charAt(pos))) {\n      pos += 1;\n    }\n    return pos < cookiesString.length;\n  }\n\n  function notSpecialChar() {\n    ch = cookiesString.charAt(pos);\n\n    return ch !== \"=\" && ch !== \";\" && ch !== \",\";\n  }\n\n  while (pos < cookiesString.length) {\n    start = pos;\n    cookiesSeparatorFound = false;\n\n    while (skipWhitespace()) {\n      ch = cookiesString.charAt(pos);\n      if (ch === \",\") {\n        // ',' is a cookie separator if we have later first '=', not ';' or ','\n        lastComma = pos;\n        pos += 1;\n\n        skipWhitespace();\n        nextStart = pos;\n\n        while (pos < cookiesString.length && notSpecialChar()) {\n          pos += 1;\n        }\n\n        // currently special character\n        if (pos < cookiesString.length && cookiesString.charAt(pos) === \"=\") {\n          // we found cookies separator\n          cookiesSeparatorFound = true;\n          // pos is inside the next cookie, so back up and return it.\n          pos = nextStart;\n          cookiesStrings.push(cookiesString.substring(start, lastComma));\n          start = pos;\n        } else {\n          // in param ',' or param separator ';',\n          // we continue from that comma\n          pos = lastComma + 1;\n        }\n      } else {\n        pos += 1;\n      }\n    }\n\n    if (!cookiesSeparatorFound || pos >= cookiesString.length) {\n      cookiesStrings.push(cookiesString.substring(start, cookiesString.length));\n    }\n  }\n\n  return cookiesStrings;\n}\n\nmodule.exports = parse;\nmodule.exports.parse = parse;\nmodule.exports.parseString = parseString;\nmodule.exports.splitCookiesString = splitCookiesString;\n", "import * as cookie from 'cookie';\nimport * as s from 'superstruct';\nimport { c as base64UrlEncode, a as base64UrlDecode, d as bytesToHex } from './base64-3538d789.js';\n\nfunction redirect(to, initialHeaders) {\n  return {\n    body: null,\n    status: 307,\n    headers: [...(initialHeaders !== null && initialHeaders !== void 0 ? initialHeaders : []), ['Location', to]]\n  };\n}\n\nconst localModeApiHandler = () => async () => ({\n  status: 500,\n  body: \"The Keystatic API route is running in a non-Node.js environment which is not supported with `storage: { kind: 'local' }`\"\n});\nconst handleGitHubAppCreation = async () => ({\n  status: 500,\n  body: 'The Keystatic API route is running in a non-Node.js environment which does not support GitHub App creation'\n});\n\nconst webcrypto = crypto;\n\nconst encoder = new TextEncoder();\nconst decoder = new TextDecoder();\nasync function deriveKey(secret, salt) {\n  if (secret.length < 32) {\n    throw new Error('KEYSTATIC_SECRET must be at least 32 characters long');\n  }\n  const encoded = encoder.encode(secret);\n  const key = await webcrypto.subtle.importKey('raw', encoded, 'HKDF', false, ['deriveKey']);\n  return webcrypto.subtle.deriveKey({\n    name: 'HKDF',\n    salt,\n    hash: 'SHA-256',\n    info: new Uint8Array(0)\n  }, key, {\n    name: 'AES-GCM',\n    length: 256\n  }, false, ['encrypt', 'decrypt']);\n}\nconst SALT_LENGTH = 16;\nconst IV_LENGTH = 12;\nasync function encryptValue(value, secret) {\n  const salt = webcrypto.getRandomValues(new Uint8Array(SALT_LENGTH));\n  const iv = webcrypto.getRandomValues(new Uint8Array(IV_LENGTH));\n  const key = await deriveKey(secret, salt);\n  const encoded = encoder.encode(value);\n  const encrypted = await webcrypto.subtle.encrypt({\n    name: 'AES-GCM',\n    iv\n  }, key, encoded);\n  const full = new Uint8Array(SALT_LENGTH + IV_LENGTH + encrypted.byteLength);\n  full.set(salt);\n  full.set(iv, SALT_LENGTH);\n  full.set(new Uint8Array(encrypted), SALT_LENGTH + IV_LENGTH);\n  return base64UrlEncode(full);\n}\nasync function decryptValue(encrypted, secret) {\n  const decoded = base64UrlDecode(encrypted);\n  const salt = decoded.slice(0, SALT_LENGTH);\n  const key = await deriveKey(secret, salt);\n  const iv = decoded.slice(SALT_LENGTH, SALT_LENGTH + IV_LENGTH);\n  const value = decoded.slice(SALT_LENGTH + IV_LENGTH);\n  const decrypted = await webcrypto.subtle.decrypt({\n    name: 'AES-GCM',\n    iv\n  }, key, value);\n  return decoder.decode(decrypted);\n}\n\nconst keystaticRouteRegex = /^branch\\/[^]+(\\/collection\\/[^/]+(|\\/(create|item\\/[^/]+))|\\/singleton\\/[^/]+)?$/;\nconst keyToEnvVar = {\n  clientId: 'KEYSTATIC_GITHUB_CLIENT_ID',\n  clientSecret: 'KEYSTATIC_GITHUB_CLIENT_SECRET',\n  secret: 'KEYSTATIC_SECRET'\n};\nfunction tryOrUndefined(fn) {\n  try {\n    return fn();\n  } catch {\n    return undefined;\n  }\n}\nfunction makeGenericAPIRouteHandler(_config, options) {\n  var _config$clientId, _config$clientSecret, _config$secret;\n  const _config2 = {\n    clientId: (_config$clientId = _config.clientId) !== null && _config$clientId !== void 0 ? _config$clientId : tryOrUndefined(() => process.env.KEYSTATIC_GITHUB_CLIENT_ID),\n    clientSecret: (_config$clientSecret = _config.clientSecret) !== null && _config$clientSecret !== void 0 ? _config$clientSecret : tryOrUndefined(() => process.env.KEYSTATIC_GITHUB_CLIENT_SECRET),\n    secret: (_config$secret = _config.secret) !== null && _config$secret !== void 0 ? _config$secret : tryOrUndefined(() => process.env.KEYSTATIC_SECRET),\n    config: _config.config\n  };\n  const getParams = req => {\n    let url;\n    try {\n      url = new URL(req.url);\n    } catch (err) {\n      throw new Error(`Found incomplete URL in Keystatic API route URL handler${(options === null || options === void 0 ? void 0 : options.slugEnvName) === 'NEXT_PUBLIC_KEYSTATIC_GITHUB_APP_SLUG' ? \". Make sure you're using the latest version of @keystatic/next\" : ''}`);\n    }\n    return url.pathname.replace(/^\\/api\\/keystatic\\/?/, '').split('/').map(x => decodeURIComponent(x)).filter(Boolean);\n  };\n  if (_config2.config.storage.kind === 'local') {\n    const handler = localModeApiHandler(_config2.config, _config.localBaseDirectory);\n    return req => {\n      const params = getParams(req);\n      return handler(req, params);\n    };\n  }\n  if (_config2.config.storage.kind === 'cloud') {\n    return async function keystaticAPIRoute() {\n      return {\n        status: 404,\n        body: 'Not Found'\n      };\n    };\n  }\n  if (!_config2.clientId || !_config2.clientSecret || !_config2.secret) {\n    if (process.env.NODE_ENV !== 'development') {\n      const missingKeys = ['clientId', 'clientSecret', 'secret'].filter(x => !_config2[x]);\n      throw new Error(`Missing required config in Keystatic API setup when using the 'github' storage mode:\\n${missingKeys.map(key => `- ${key} (can be provided via ${keyToEnvVar[key]} env var)`).join('\\n')}\\n\\nIf you've created your GitHub app locally, make sure to copy the environment variables from your local env file to your deployed environment`);\n    }\n    return async function keystaticAPIRoute(req) {\n      const params = getParams(req);\n      const joined = params.join('/');\n      if (joined === 'github/created-app') {\n        return createdGithubApp(req, options === null || options === void 0 ? void 0 : options.slugEnvName);\n      }\n      if (joined === 'github/login' || joined === 'github/repo-not-found' || joined === 'github/logout') {\n        return redirect('/keystatic/setup');\n      }\n      return {\n        status: 404,\n        body: 'Not Found'\n      };\n    };\n  }\n  const config = {\n    clientId: _config2.clientId,\n    clientSecret: _config2.clientSecret,\n    secret: _config2.secret,\n    config: _config2.config\n  };\n  return async function keystaticAPIRoute(req) {\n    const params = getParams(req);\n    const joined = params.join('/');\n    if (joined === 'github/oauth/callback') {\n      return githubOauthCallback(req, config);\n    }\n    if (joined === 'github/login') {\n      return githubLogin(req, config);\n    }\n    if (joined === 'github/refresh-token') {\n      return githubRefreshToken(req, config);\n    }\n    if (joined === 'github/repo-not-found') {\n      return githubRepoNotFound(req, config);\n    }\n    if (joined === 'github/logout') {\n      var _req$headers$get;\n      const cookies = cookie.parse((_req$headers$get = req.headers.get('cookie')) !== null && _req$headers$get !== void 0 ? _req$headers$get : '');\n      const access_token = cookies['keystatic-gh-access-token'];\n      if (access_token) {\n        await fetch(`https://api.github.com/applications/${config.clientId}/token`, {\n          method: 'DELETE',\n          headers: {\n            Authorization: `Basic ${btoa(config.clientId + ':' + config.clientSecret)}`\n          },\n          body: JSON.stringify({\n            access_token\n          })\n        });\n      }\n      return redirect('/keystatic', [['Set-Cookie', immediatelyExpiringCookie('keystatic-gh-access-token')], ['Set-Cookie', immediatelyExpiringCookie('keystatic-gh-refresh-token')]]);\n    }\n    return {\n      status: 404,\n      body: 'Not Found'\n    };\n  };\n}\nconst tokenDataResultType = s.type({\n  access_token: s.string(),\n  expires_in: s.number(),\n  refresh_token: s.string(),\n  refresh_token_expires_in: s.number(),\n  scope: s.string(),\n  token_type: s.literal('bearer')\n});\nasync function githubOauthCallback(req, config) {\n  var _req$headers$get2;\n  const searchParams = new URL(req.url, 'http://localhost').searchParams;\n  const error = searchParams.get('error');\n  const errorDescription = searchParams.get('error_description');\n  if (typeof errorDescription === 'string') {\n    return {\n      status: 400,\n      body: `An error occurred when trying to authenticate with GitHub:\\n${errorDescription}${error === 'redirect_uri_mismatch' ? `\\n\\nIf you were trying to sign in locally and recently upgraded Keystatic from @keystatic/core@0.0.69 or below, you need to add \\`http://127.0.0.1/api/keystatic/github/oauth/callback\\` as a callback URL in your GitHub app.` : ''}`\n    };\n  }\n  const code = searchParams.get('code');\n  const state = searchParams.get('state');\n  if (typeof code !== 'string') {\n    return {\n      status: 400,\n      body: 'Bad Request'\n    };\n  }\n  const cookies = cookie.parse((_req$headers$get2 = req.headers.get('cookie')) !== null && _req$headers$get2 !== void 0 ? _req$headers$get2 : '');\n  const fromCookie = state ? cookies['ks-' + state] : undefined;\n  const from = typeof fromCookie === 'string' && keystaticRouteRegex.test(fromCookie) ? fromCookie : undefined;\n  const url = new URL('https://github.com/login/oauth/access_token');\n  url.searchParams.set('client_id', config.clientId);\n  url.searchParams.set('client_secret', config.clientSecret);\n  url.searchParams.set('code', code);\n  const tokenRes = await fetch(url, {\n    method: 'POST',\n    headers: {\n      Accept: 'application/json'\n    }\n  });\n  if (!tokenRes.ok) {\n    return {\n      status: 401,\n      body: 'Authorization failed'\n    };\n  }\n  const _tokenData = await tokenRes.json();\n  let tokenData;\n  try {\n    tokenData = tokenDataResultType.create(_tokenData);\n  } catch {\n    return {\n      status: 401,\n      body: 'Authorization failed'\n    };\n  }\n  const headers = await getTokenCookies(tokenData, config);\n  if (state === 'close') {\n    return {\n      headers: [...headers, ['Content-Type', 'text/html']],\n      body: \"<script>localStorage.setItem('ks-refetch-installations', 'true');window.close();</script>\",\n      status: 200\n    };\n  }\n  return redirect(`/keystatic${from ? `/${from}` : ''}`, headers);\n}\nasync function getTokenCookies(tokenData, config) {\n  const headers = [['Set-Cookie', cookie.serialize('keystatic-gh-access-token', tokenData.access_token, {\n    sameSite: 'lax',\n    secure: process.env.NODE_ENV === 'production',\n    maxAge: tokenData.expires_in,\n    expires: new Date(Date.now() + tokenData.expires_in * 1000),\n    path: '/'\n  })], ['Set-Cookie', cookie.serialize('keystatic-gh-refresh-token', await encryptValue(tokenData.refresh_token, config.secret), {\n    sameSite: 'lax',\n    secure: process.env.NODE_ENV === 'production',\n    httpOnly: true,\n    maxAge: tokenData.refresh_token_expires_in,\n    expires: new Date(Date.now() + tokenData.refresh_token_expires_in * 100),\n    path: '/'\n  })]];\n  return headers;\n}\nasync function getRefreshToken(req, config) {\n  const cookies = cookie.parse(req.headers.get('cookie') || '');\n  const refreshTokenCookie = cookies['keystatic-gh-refresh-token'];\n  if (!refreshTokenCookie) return;\n  let refreshToken;\n  try {\n    refreshToken = await decryptValue(refreshTokenCookie, config.secret);\n  } catch {\n    return;\n  }\n  return refreshToken;\n}\nasync function githubRefreshToken(req, config) {\n  const headers = await refreshGitHubAuth(req, config);\n  if (!headers) {\n    return {\n      status: 401,\n      body: 'Authorization failed'\n    };\n  }\n  return {\n    status: 200,\n    headers,\n    body: ''\n  };\n}\nasync function refreshGitHubAuth(req, config) {\n  const refreshToken = await getRefreshToken(req, config);\n  if (!refreshToken) {\n    return;\n  }\n  const url = new URL('https://github.com/login/oauth/access_token');\n  url.searchParams.set('client_id', config.clientId);\n  url.searchParams.set('client_secret', config.clientSecret);\n  url.searchParams.set('grant_type', 'refresh_token');\n  url.searchParams.set('refresh_token', refreshToken);\n  const tokenRes = await fetch(url, {\n    method: 'POST',\n    headers: {\n      Accept: 'application/json'\n    }\n  });\n  if (!tokenRes.ok) {\n    return;\n  }\n  const _tokenData = await tokenRes.json();\n  let tokenData;\n  try {\n    tokenData = tokenDataResultType.create(_tokenData);\n  } catch {\n    return;\n  }\n  return getTokenCookies(tokenData, config);\n}\nasync function githubRepoNotFound(req, config) {\n  const headers = await refreshGitHubAuth(req, config);\n  if (headers) {\n    return redirect('/keystatic/repo-not-found', headers);\n  }\n  return githubLogin(req, config);\n}\nasync function githubLogin(req, config) {\n  const reqUrl = new URL(req.url);\n  const rawFrom = reqUrl.searchParams.get('from');\n  const from = typeof rawFrom === 'string' && keystaticRouteRegex.test(rawFrom) ? rawFrom : '/';\n  const state = bytesToHex(webcrypto.getRandomValues(new Uint8Array(10)));\n  const url = new URL('https://github.com/login/oauth/authorize');\n  url.searchParams.set('client_id', config.clientId);\n  url.searchParams.set('redirect_uri', `${reqUrl.origin}/api/keystatic/github/oauth/callback`);\n  if (from === '/') {\n    return redirect(url.toString());\n  }\n  url.searchParams.set('state', state);\n  return redirect(url.toString(), [['Set-Cookie', cookie.serialize('ks-' + state, from, {\n    sameSite: 'lax',\n    secure: process.env.NODE_ENV === 'production',\n    // 1 day\n    maxAge: 60 * 60 * 24,\n    expires: new Date(Date.now() + 60 * 60 * 24 * 1000),\n    path: '/',\n    httpOnly: true\n  })]]);\n}\nasync function createdGithubApp(req, slugEnvVarName) {\n  if (process.env.NODE_ENV !== 'development') {\n    return {\n      status: 400,\n      body: 'App setup only allowed in development'\n    };\n  }\n  return handleGitHubAppCreation();\n}\nfunction immediatelyExpiringCookie(name) {\n  return cookie.serialize(name, '', {\n    secure: process.env.NODE_ENV === 'production',\n    sameSite: 'lax',\n    path: '/',\n    maxAge: 0,\n    expires: new Date()\n  });\n}\n\nexport { makeGenericAPIRouteHandler };\n", "import { makeGenericAPIRouteHandler } from '@keystatic/core/api/generic';\nimport { parseString } from 'set-cookie-parser';\n\nfunction makeHandler(_config) {\n  return async function keystaticAPIRoute(context) {\n    var _context$locals, _ref, _config$clientId, _ref2, _config$clientSecret, _ref3, _config$secret;\n    const envVarsForCf = (_context$locals = context.locals) === null || _context$locals === void 0 || (_context$locals = _context$locals.runtime) === null || _context$locals === void 0 ? void 0 : _context$locals.env;\n    const handler = makeGenericAPIRouteHandler({\n      ..._config,\n      clientId: (_ref = (_config$clientId = _config.clientId) !== null && _config$clientId !== void 0 ? _config$clientId : envVarsForCf === null || envVarsForCf === void 0 ? void 0 : envVarsForCf.KEYSTATIC_GITHUB_CLIENT_ID) !== null && _ref !== void 0 ? _ref : tryOrUndefined(() => {\n        return import.meta.env.KEYSTATIC_GITHUB_CLIENT_ID;\n      }),\n      clientSecret: (_ref2 = (_config$clientSecret = _config.clientSecret) !== null && _config$clientSecret !== void 0 ? _config$clientSecret : envVarsForCf === null || envVarsForCf === void 0 ? void 0 : envVarsForCf.KEYSTATIC_GITHUB_CLIENT_SECRET) !== null && _ref2 !== void 0 ? _ref2 : tryOrUndefined(() => {\n        return import.meta.env.KEYSTATIC_GITHUB_CLIENT_SECRET;\n      }),\n      secret: (_ref3 = (_config$secret = _config.secret) !== null && _config$secret !== void 0 ? _config$secret : envVarsForCf === null || envVarsForCf === void 0 ? void 0 : envVarsForCf.KEYSTATIC_SECRET) !== null && _ref3 !== void 0 ? _ref3 : tryOrUndefined(() => {\n        return import.meta.env.KEYSTATIC_SECRET;\n      })\n    }, {\n      slugEnvName: 'PUBLIC_KEYSTATIC_GITHUB_APP_SLUG'\n    });\n    const {\n      body,\n      headers,\n      status\n    } = await handler(context.request);\n    // all this stuff should be able to go away when astro is using a version of undici with getSetCookie\n    let headersInADifferentStructure = new Map();\n    if (headers) {\n      if (Array.isArray(headers)) {\n        for (const [key, value] of headers) {\n          if (!headersInADifferentStructure.has(key.toLowerCase())) {\n            headersInADifferentStructure.set(key.toLowerCase(), []);\n          }\n          headersInADifferentStructure.get(key.toLowerCase()).push(value);\n        }\n      } else if (typeof headers.entries === 'function') {\n        for (const [key, value] of headers.entries()) {\n          headersInADifferentStructure.set(key.toLowerCase(), [value]);\n        }\n        if ('getSetCookie' in headers && typeof headers.getSetCookie === 'function') {\n          const setCookieHeaders = headers.getSetCookie();\n          if (setCookieHeaders !== null && setCookieHeaders !== void 0 && setCookieHeaders.length) {\n            headersInADifferentStructure.set('set-cookie', setCookieHeaders);\n          }\n        }\n      } else {\n        for (const [key, value] of Object.entries(headers)) {\n          headersInADifferentStructure.set(key.toLowerCase(), [value]);\n        }\n      }\n    }\n    const setCookieHeaders = headersInADifferentStructure.get('set-cookie');\n    headersInADifferentStructure.delete('set-cookie');\n    if (setCookieHeaders) {\n      for (const setCookieValue of setCookieHeaders) {\n        var _options$sameSite;\n        const {\n          name,\n          value,\n          ...options\n        } = parseString(setCookieValue);\n        const sameSite = (_options$sameSite = options.sameSite) === null || _options$sameSite === void 0 ? void 0 : _options$sameSite.toLowerCase();\n        context.cookies.set(name, value, {\n          domain: options.domain,\n          expires: options.expires,\n          httpOnly: options.httpOnly,\n          maxAge: options.maxAge,\n          path: options.path,\n          sameSite: sameSite === 'lax' || sameSite === 'strict' || sameSite === 'none' ? sameSite : undefined\n        });\n      }\n    }\n    return new Response(body, {\n      status,\n      headers: [...headersInADifferentStructure.entries()].flatMap(([key, val]) => val.map(x => [key, x]))\n    });\n  };\n}\nfunction tryOrUndefined(fn) {\n  try {\n    return fn();\n  } catch {\n    return undefined;\n  }\n}\n\nexport { makeHandler };\n"],
  "mappings": ";;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAEA,QAAI,sBAAsB;AAAA,MACxB,cAAc;AAAA,MACd,KAAK;AAAA,MACL,QAAQ;AAAA,IACV;AAEA,aAAS,iBAAiB,KAAK;AAC7B,aAAO,OAAO,QAAQ,YAAY,CAAC,CAAC,IAAI,KAAK;AAAA,IAC/C;AAEA,aAASA,aAAY,gBAAgB,SAAS;AAC5C,UAAI,QAAQ,eAAe,MAAM,GAAG,EAAE,OAAO,gBAAgB;AAE7D,UAAI,mBAAmB,MAAM,MAAM;AACnC,UAAI,SAAS,mBAAmB,gBAAgB;AAChD,UAAI,OAAO,OAAO;AAClB,UAAI,QAAQ,OAAO;AAEnB,gBAAU,UACN,OAAO,OAAO,CAAC,GAAG,qBAAqB,OAAO,IAC9C;AAEJ,UAAI;AACF,gBAAQ,QAAQ,eAAe,mBAAmB,KAAK,IAAI;AAAA,MAC7D,SAAS,GAAG;AACV,gBAAQ;AAAA,UACN,gFACE,QACA;AAAA,UACF;AAAA,QACF;AAAA,MACF;AAEA,UAAIC,UAAS;AAAA,QACX;AAAA,QACA;AAAA,MACF;AAEA,YAAM,QAAQ,SAAU,MAAM;AAC5B,YAAI,QAAQ,KAAK,MAAM,GAAG;AAC1B,YAAI,MAAM,MAAM,MAAM,EAAE,SAAS,EAAE,YAAY;AAC/C,YAAIC,SAAQ,MAAM,KAAK,GAAG;AAC1B,YAAI,QAAQ,WAAW;AACrB,UAAAD,QAAO,UAAU,IAAI,KAAKC,MAAK;AAAA,QACjC,WAAW,QAAQ,WAAW;AAC5B,UAAAD,QAAO,SAAS,SAASC,QAAO,EAAE;AAAA,QACpC,WAAW,QAAQ,UAAU;AAC3B,UAAAD,QAAO,SAAS;AAAA,QAClB,WAAW,QAAQ,YAAY;AAC7B,UAAAA,QAAO,WAAW;AAAA,QACpB,WAAW,QAAQ,YAAY;AAC7B,UAAAA,QAAO,WAAWC;AAAA,QACpB,OAAO;AACL,UAAAD,QAAO,GAAG,IAAIC;AAAA,QAChB;AAAA,MACF,CAAC;AAED,aAAOD;AAAA,IACT;AAEA,aAAS,mBAAmB,kBAAkB;AAG5C,UAAI,OAAO;AACX,UAAI,QAAQ;AACZ,UAAI,eAAe,iBAAiB,MAAM,GAAG;AAC7C,UAAI,aAAa,SAAS,GAAG;AAC3B,eAAO,aAAa,MAAM;AAC1B,gBAAQ,aAAa,KAAK,GAAG;AAAA,MAC/B,OAAO;AACL,gBAAQ;AAAA,MACV;AAEA,aAAO,EAAE,MAAY,MAAa;AAAA,IACpC;AAEA,aAASE,OAAM,OAAO,SAAS;AAC7B,gBAAU,UACN,OAAO,OAAO,CAAC,GAAG,qBAAqB,OAAO,IAC9C;AAEJ,UAAI,CAAC,OAAO;AACV,YAAI,CAAC,QAAQ,KAAK;AAChB,iBAAO,CAAC;AAAA,QACV,OAAO;AACL,iBAAO,CAAC;AAAA,QACV;AAAA,MACF;AAEA,UAAI,MAAM,SAAS;AACjB,YAAI,OAAO,MAAM,QAAQ,iBAAiB,YAAY;AAGpD,kBAAQ,MAAM,QAAQ,aAAa;AAAA,QACrC,WAAW,MAAM,QAAQ,YAAY,GAAG;AAEtC,kBAAQ,MAAM,QAAQ,YAAY;AAAA,QACpC,OAAO;AAEL,cAAI,MACF,MAAM,QACJ,OAAO,KAAK,MAAM,OAAO,EAAE,KAAK,SAAU,KAAK;AAC7C,mBAAO,IAAI,YAAY,MAAM;AAAA,UAC/B,CAAC,CACH;AAEF,cAAI,CAAC,OAAO,MAAM,QAAQ,UAAU,CAAC,QAAQ,QAAQ;AACnD,oBAAQ;AAAA,cACN;AAAA,YACF;AAAA,UACF;AACA,kBAAQ;AAAA,QACV;AAAA,MACF;AACA,UAAI,CAAC,MAAM,QAAQ,KAAK,GAAG;AACzB,gBAAQ,CAAC,KAAK;AAAA,MAChB;AAEA,gBAAU,UACN,OAAO,OAAO,CAAC,GAAG,qBAAqB,OAAO,IAC9C;AAEJ,UAAI,CAAC,QAAQ,KAAK;AAChB,eAAO,MAAM,OAAO,gBAAgB,EAAE,IAAI,SAAU,KAAK;AACvD,iBAAOH,aAAY,KAAK,OAAO;AAAA,QACjC,CAAC;AAAA,MACH,OAAO;AACL,YAAI,UAAU,CAAC;AACf,eAAO,MAAM,OAAO,gBAAgB,EAAE,OAAO,SAAUI,UAAS,KAAK;AACnE,cAAIH,UAASD,aAAY,KAAK,OAAO;AACrC,UAAAI,SAAQH,QAAO,IAAI,IAAIA;AACvB,iBAAOG;AAAA,QACT,GAAG,OAAO;AAAA,MACZ;AAAA,IACF;AAaA,aAAS,mBAAmB,eAAe;AACzC,UAAI,MAAM,QAAQ,aAAa,GAAG;AAChC,eAAO;AAAA,MACT;AACA,UAAI,OAAO,kBAAkB,UAAU;AACrC,eAAO,CAAC;AAAA,MACV;AAEA,UAAI,iBAAiB,CAAC;AACtB,UAAI,MAAM;AACV,UAAI;AACJ,UAAI;AACJ,UAAI;AACJ,UAAI;AACJ,UAAI;AAEJ,eAAS,iBAAiB;AACxB,eAAO,MAAM,cAAc,UAAU,KAAK,KAAK,cAAc,OAAO,GAAG,CAAC,GAAG;AACzE,iBAAO;AAAA,QACT;AACA,eAAO,MAAM,cAAc;AAAA,MAC7B;AAEA,eAAS,iBAAiB;AACxB,aAAK,cAAc,OAAO,GAAG;AAE7B,eAAO,OAAO,OAAO,OAAO,OAAO,OAAO;AAAA,MAC5C;AAEA,aAAO,MAAM,cAAc,QAAQ;AACjC,gBAAQ;AACR,gCAAwB;AAExB,eAAO,eAAe,GAAG;AACvB,eAAK,cAAc,OAAO,GAAG;AAC7B,cAAI,OAAO,KAAK;AAEd,wBAAY;AACZ,mBAAO;AAEP,2BAAe;AACf,wBAAY;AAEZ,mBAAO,MAAM,cAAc,UAAU,eAAe,GAAG;AACrD,qBAAO;AAAA,YACT;AAGA,gBAAI,MAAM,cAAc,UAAU,cAAc,OAAO,GAAG,MAAM,KAAK;AAEnE,sCAAwB;AAExB,oBAAM;AACN,6BAAe,KAAK,cAAc,UAAU,OAAO,SAAS,CAAC;AAC7D,sBAAQ;AAAA,YACV,OAAO;AAGL,oBAAM,YAAY;AAAA,YACpB;AAAA,UACF,OAAO;AACL,mBAAO;AAAA,UACT;AAAA,QACF;AAEA,YAAI,CAAC,yBAAyB,OAAO,cAAc,QAAQ;AACzD,yBAAe,KAAK,cAAc,UAAU,OAAO,cAAc,MAAM,CAAC;AAAA,QAC1E;AAAA,MACF;AAEA,aAAO;AAAA,IACT;AAEA,WAAO,UAAUD;AACjB,WAAO,QAAQ,QAAQA;AACvB,WAAO,QAAQ,cAAcH;AAC7B,WAAO,QAAQ,qBAAqB;AAAA;AAAA;;;ACjOpC,aAAwB;AAIxB,SAAS,SAAS,IAAI,gBAAgB;AACpC,SAAO;AAAA,IACL,MAAM;AAAA,IACN,QAAQ;AAAA,IACR,SAAS,CAAC,GAAI,mBAAmB,QAAQ,mBAAmB,SAAS,iBAAiB,CAAC,GAAI,CAAC,YAAY,EAAE,CAAC;AAAA,EAC7G;AACF;AAEA,IAAM,sBAAsB,MAAM,aAAa;AAAA,EAC7C,QAAQ;AAAA,EACR,MAAM;AACR;AACA,IAAM,0BAA0B,aAAa;AAAA,EAC3C,QAAQ;AAAA,EACR,MAAM;AACR;AAEA,IAAM,YAAY;AAElB,IAAM,UAAU,IAAI,YAAY;AAChC,IAAM,UAAU,IAAI,YAAY;AAChC,eAAe,UAAU,QAAQ,MAAM;AACrC,MAAI,OAAO,SAAS,IAAI;AACtB,UAAM,IAAI,MAAM,sDAAsD;AAAA,EACxE;AACA,QAAM,UAAU,QAAQ,OAAO,MAAM;AACrC,QAAM,MAAM,MAAM,UAAU,OAAO,UAAU,OAAO,SAAS,QAAQ,OAAO,CAAC,WAAW,CAAC;AACzF,SAAO,UAAU,OAAO,UAAU;AAAA,IAChC,MAAM;AAAA,IACN;AAAA,IACA,MAAM;AAAA,IACN,MAAM,IAAI,WAAW,CAAC;AAAA,EACxB,GAAG,KAAK;AAAA,IACN,MAAM;AAAA,IACN,QAAQ;AAAA,EACV,GAAG,OAAO,CAAC,WAAW,SAAS,CAAC;AAClC;AACA,IAAM,cAAc;AACpB,IAAM,YAAY;AAClB,eAAe,aAAa,OAAO,QAAQ;AACzC,QAAM,OAAO,UAAU,gBAAgB,IAAI,WAAW,WAAW,CAAC;AAClE,QAAM,KAAK,UAAU,gBAAgB,IAAI,WAAW,SAAS,CAAC;AAC9D,QAAM,MAAM,MAAM,UAAU,QAAQ,IAAI;AACxC,QAAM,UAAU,QAAQ,OAAO,KAAK;AACpC,QAAM,YAAY,MAAM,UAAU,OAAO,QAAQ;AAAA,IAC/C,MAAM;AAAA,IACN;AAAA,EACF,GAAG,KAAK,OAAO;AACf,QAAM,OAAO,IAAI,WAAW,cAAc,YAAY,UAAU,UAAU;AAC1E,OAAK,IAAI,IAAI;AACb,OAAK,IAAI,IAAI,WAAW;AACxB,OAAK,IAAI,IAAI,WAAW,SAAS,GAAG,cAAc,SAAS;AAC3D,SAAO,gBAAgB,IAAI;AAC7B;AACA,eAAe,aAAa,WAAW,QAAQ;AAC7C,QAAM,UAAU,gBAAgB,SAAS;AACzC,QAAM,OAAO,QAAQ,MAAM,GAAG,WAAW;AACzC,QAAM,MAAM,MAAM,UAAU,QAAQ,IAAI;AACxC,QAAM,KAAK,QAAQ,MAAM,aAAa,cAAc,SAAS;AAC7D,QAAM,QAAQ,QAAQ,MAAM,cAAc,SAAS;AACnD,QAAM,YAAY,MAAM,UAAU,OAAO,QAAQ;AAAA,IAC/C,MAAM;AAAA,IACN;AAAA,EACF,GAAG,KAAK,KAAK;AACb,SAAO,QAAQ,OAAO,SAAS;AACjC;AAEA,IAAM,sBAAsB;AAM5B,SAAS,eAAe,IAAI;AAC1B,MAAI;AACF,WAAO,GAAG;AAAA,EACZ,QAAQ;AACN,WAAO;AAAA,EACT;AACF;AACA,SAAS,2BAA2B,SAAS,SAAS;AACpD,MAAI,kBAAkB,sBAAsB;AAC5C,QAAM,WAAW;AAAA,IACf,WAAW,mBAAmB,QAAQ,cAAc,QAAQ,qBAAqB,SAAS,mBAAmB,eAAe,MAAM,QAAQ,IAAI,0BAA0B;AAAA,IACxK,eAAe,uBAAuB,QAAQ,kBAAkB,QAAQ,yBAAyB,SAAS,uBAAuB,eAAe,MAAM,QAAQ,IAAI,8BAA8B;AAAA,IAChM,SAAS,iBAAiB,QAAQ,YAAY,QAAQ,mBAAmB,SAAS,iBAAiB,eAAe,MAAM,QAAQ,IAAI,gBAAgB;AAAA,IACpJ,QAAQ,QAAQ;AAAA,EAClB;AACA,QAAM,YAAY,SAAO;AACvB,QAAI;AACJ,QAAI;AACF,YAAM,IAAI,IAAI,IAAI,GAAG;AAAA,IACvB,SAAS,KAAK;AACZ,YAAM,IAAI,MAAM,2DAA2D,YAAY,QAAQ,YAAY,SAAS,SAAS,QAAQ,iBAAiB,0CAA0C,mEAAmE,EAAE,EAAE;AAAA,IACzQ;AACA,WAAO,IAAI,SAAS,QAAQ,wBAAwB,EAAE,EAAE,MAAM,GAAG,EAAE,IAAI,OAAK,mBAAmB,CAAC,CAAC,EAAE,OAAO,OAAO;AAAA,EACnH;AACA,MAAI,SAAS,OAAO,QAAQ,SAAS,SAAS;AAC5C,UAAM,UAAU,oBAAoB,SAAS,QAAQ,QAAQ,kBAAkB;AAC/E,WAAO,SAAO;AACZ,YAAM,SAAS,UAAU,GAAG;AAC5B,aAAO,QAAQ,KAAK,MAAM;AAAA,IAC5B;AAAA,EACF;AACA,MAAI,SAAS,OAAO,QAAQ,SAAS,SAAS;AAC5C,WAAO,eAAe,oBAAoB;AACxC,aAAO;AAAA,QACL,QAAQ;AAAA,QACR,MAAM;AAAA,MACR;AAAA,IACF;AAAA,EACF;AACA,MAAI,CAAC,SAAS,YAAY,CAAC,SAAS,gBAAgB,CAAC,SAAS,QAAQ;AACpE,QAAI,OAAwC;AAC1C,YAAM,cAAc,CAAC,YAAY,gBAAgB,QAAQ,EAAE,OAAO,OAAK,CAAC,SAAS,CAAC,CAAC;AACnF,YAAM,IAAI,MAAM;AAAA,EAAyF,YAAY,IAAI,SAAO,KAAK,GAAG,yBAAyB,YAAY,GAAG,CAAC,WAAW,EAAE,KAAK,IAAI,CAAC;AAAA;AAAA,6IAAkJ;AAAA,IAC5V;AACA,WAAO,eAAe,kBAAkB,KAAK;AAC3C,YAAM,SAAS,UAAU,GAAG;AAC5B,YAAM,SAAS,OAAO,KAAK,GAAG;AAC9B,UAAI,WAAW,sBAAsB;AACnC,eAAO,iBAAiB,KAAK,YAAY,QAAQ,YAAY,SAAS,SAAS,QAAQ,WAAW;AAAA,MACpG;AACA,UAAI,WAAW,kBAAkB,WAAW,2BAA2B,WAAW,iBAAiB;AACjG,eAAO,SAAS,kBAAkB;AAAA,MACpC;AACA,aAAO;AAAA,QACL,QAAQ;AAAA,QACR,MAAM;AAAA,MACR;AAAA,IACF;AAAA,EACF;AACA,QAAM,SAAS;AAAA,IACb,UAAU,SAAS;AAAA,IACnB,cAAc,SAAS;AAAA,IACvB,QAAQ,SAAS;AAAA,IACjB,QAAQ,SAAS;AAAA,EACnB;AACA,SAAO,eAAe,kBAAkB,KAAK;AAC3C,UAAM,SAAS,UAAU,GAAG;AAC5B,UAAM,SAAS,OAAO,KAAK,GAAG;AAC9B,QAAI,WAAW,yBAAyB;AACtC,aAAO,oBAAoB,KAAK,MAAM;AAAA,IACxC;AACA,QAAI,WAAW,gBAAgB;AAC7B,aAAO,YAAY,KAAK,MAAM;AAAA,IAChC;AACA,QAAI,WAAW,wBAAwB;AACrC,aAAO,mBAAmB,KAAK,MAAM;AAAA,IACvC;AACA,QAAI,WAAW,yBAAyB;AACtC,aAAO,mBAAmB,KAAK,MAAM;AAAA,IACvC;AACA,QAAI,WAAW,iBAAiB;AAC9B,UAAI;AACJ,YAAM,UAAiB,cAAO,mBAAmB,IAAI,QAAQ,IAAI,QAAQ,OAAO,QAAQ,qBAAqB,SAAS,mBAAmB,EAAE;AAC3I,YAAM,eAAe,QAAQ,2BAA2B;AACxD,UAAI,cAAc;AAChB,cAAM,MAAM,uCAAuC,OAAO,QAAQ,UAAU;AAAA,UAC1E,QAAQ;AAAA,UACR,SAAS;AAAA,YACP,eAAe,SAAS,KAAK,OAAO,WAAW,MAAM,OAAO,YAAY,CAAC;AAAA,UAC3E;AAAA,UACA,MAAM,KAAK,UAAU;AAAA,YACnB;AAAA,UACF,CAAC;AAAA,QACH,CAAC;AAAA,MACH;AACA,aAAO,SAAS,cAAc,CAAC,CAAC,cAAc,0BAA0B,2BAA2B,CAAC,GAAG,CAAC,cAAc,0BAA0B,4BAA4B,CAAC,CAAC,CAAC;AAAA,IACjL;AACA,WAAO;AAAA,MACL,QAAQ;AAAA,MACR,MAAM;AAAA,IACR;AAAA,EACF;AACF;AACA,IAAM,sBAAwB,KAAK;AAAA,EACjC,cAAgB,OAAO;AAAA,EACvB,YAAc,OAAO;AAAA,EACrB,eAAiB,OAAO;AAAA,EACxB,0BAA4B,OAAO;AAAA,EACnC,OAAS,OAAO;AAAA,EAChB,YAAc,QAAQ,QAAQ;AAChC,CAAC;AACD,eAAe,oBAAoB,KAAK,QAAQ;AAC9C,MAAI;AACJ,QAAM,eAAe,IAAI,IAAI,IAAI,KAAK,kBAAkB,EAAE;AAC1D,QAAM,QAAQ,aAAa,IAAI,OAAO;AACtC,QAAM,mBAAmB,aAAa,IAAI,mBAAmB;AAC7D,MAAI,OAAO,qBAAqB,UAAU;AACxC,WAAO;AAAA,MACL,QAAQ;AAAA,MACR,MAAM;AAAA,EAA+D,gBAAgB,GAAG,UAAU,0BAA0B;AAAA;AAAA,8NAAmO,EAAE;AAAA,IACnW;AAAA,EACF;AACA,QAAM,OAAO,aAAa,IAAI,MAAM;AACpC,QAAM,QAAQ,aAAa,IAAI,OAAO;AACtC,MAAI,OAAO,SAAS,UAAU;AAC5B,WAAO;AAAA,MACL,QAAQ;AAAA,MACR,MAAM;AAAA,IACR;AAAA,EACF;AACA,QAAM,UAAiB,cAAO,oBAAoB,IAAI,QAAQ,IAAI,QAAQ,OAAO,QAAQ,sBAAsB,SAAS,oBAAoB,EAAE;AAC9I,QAAM,aAAa,QAAQ,QAAQ,QAAQ,KAAK,IAAI;AACpD,QAAM,OAAO,OAAO,eAAe,YAAY,oBAAoB,KAAK,UAAU,IAAI,aAAa;AACnG,QAAM,MAAM,IAAI,IAAI,6CAA6C;AACjE,MAAI,aAAa,IAAI,aAAa,OAAO,QAAQ;AACjD,MAAI,aAAa,IAAI,iBAAiB,OAAO,YAAY;AACzD,MAAI,aAAa,IAAI,QAAQ,IAAI;AACjC,QAAM,WAAW,MAAM,MAAM,KAAK;AAAA,IAChC,QAAQ;AAAA,IACR,SAAS;AAAA,MACP,QAAQ;AAAA,IACV;AAAA,EACF,CAAC;AACD,MAAI,CAAC,SAAS,IAAI;AAChB,WAAO;AAAA,MACL,QAAQ;AAAA,MACR,MAAM;AAAA,IACR;AAAA,EACF;AACA,QAAM,aAAa,MAAM,SAAS,KAAK;AACvC,MAAI;AACJ,MAAI;AACF,gBAAY,oBAAoB,OAAO,UAAU;AAAA,EACnD,QAAQ;AACN,WAAO;AAAA,MACL,QAAQ;AAAA,MACR,MAAM;AAAA,IACR;AAAA,EACF;AACA,QAAM,UAAU,MAAM,gBAAgB,WAAW,MAAM;AACvD,MAAI,UAAU,SAAS;AACrB,WAAO;AAAA,MACL,SAAS,CAAC,GAAG,SAAS,CAAC,gBAAgB,WAAW,CAAC;AAAA,MACnD,MAAM;AAAA,MACN,QAAQ;AAAA,IACV;AAAA,EACF;AACA,SAAO,SAAS,aAAa,OAAO,IAAI,IAAI,KAAK,EAAE,IAAI,OAAO;AAChE;AACA,eAAe,gBAAgB,WAAW,QAAQ;AAChD,QAAM,UAAU,CAAC,CAAC,cAAqB,iBAAU,6BAA6B,UAAU,cAAc;AAAA,IACpG,UAAU;AAAA,IACV,QAAQ;AAAA,IACR,QAAQ,UAAU;AAAA,IAClB,SAAS,IAAI,KAAK,KAAK,IAAI,IAAI,UAAU,aAAa,GAAI;AAAA,IAC1D,MAAM;AAAA,EACR,CAAC,CAAC,GAAG,CAAC,cAAqB,iBAAU,8BAA8B,MAAM,aAAa,UAAU,eAAe,OAAO,MAAM,GAAG;AAAA,IAC7H,UAAU;AAAA,IACV,QAAQ;AAAA,IACR,UAAU;AAAA,IACV,QAAQ,UAAU;AAAA,IAClB,SAAS,IAAI,KAAK,KAAK,IAAI,IAAI,UAAU,2BAA2B,GAAG;AAAA,IACvE,MAAM;AAAA,EACR,CAAC,CAAC,CAAC;AACH,SAAO;AACT;AACA,eAAe,gBAAgB,KAAK,QAAQ;AAC1C,QAAM,UAAiB,aAAM,IAAI,QAAQ,IAAI,QAAQ,KAAK,EAAE;AAC5D,QAAM,qBAAqB,QAAQ,4BAA4B;AAC/D,MAAI,CAAC,mBAAoB;AACzB,MAAI;AACJ,MAAI;AACF,mBAAe,MAAM,aAAa,oBAAoB,OAAO,MAAM;AAAA,EACrE,QAAQ;AACN;AAAA,EACF;AACA,SAAO;AACT;AACA,eAAe,mBAAmB,KAAK,QAAQ;AAC7C,QAAM,UAAU,MAAM,kBAAkB,KAAK,MAAM;AACnD,MAAI,CAAC,SAAS;AACZ,WAAO;AAAA,MACL,QAAQ;AAAA,MACR,MAAM;AAAA,IACR;AAAA,EACF;AACA,SAAO;AAAA,IACL,QAAQ;AAAA,IACR;AAAA,IACA,MAAM;AAAA,EACR;AACF;AACA,eAAe,kBAAkB,KAAK,QAAQ;AAC5C,QAAM,eAAe,MAAM,gBAAgB,KAAK,MAAM;AACtD,MAAI,CAAC,cAAc;AACjB;AAAA,EACF;AACA,QAAM,MAAM,IAAI,IAAI,6CAA6C;AACjE,MAAI,aAAa,IAAI,aAAa,OAAO,QAAQ;AACjD,MAAI,aAAa,IAAI,iBAAiB,OAAO,YAAY;AACzD,MAAI,aAAa,IAAI,cAAc,eAAe;AAClD,MAAI,aAAa,IAAI,iBAAiB,YAAY;AAClD,QAAM,WAAW,MAAM,MAAM,KAAK;AAAA,IAChC,QAAQ;AAAA,IACR,SAAS;AAAA,MACP,QAAQ;AAAA,IACV;AAAA,EACF,CAAC;AACD,MAAI,CAAC,SAAS,IAAI;AAChB;AAAA,EACF;AACA,QAAM,aAAa,MAAM,SAAS,KAAK;AACvC,MAAI;AACJ,MAAI;AACF,gBAAY,oBAAoB,OAAO,UAAU;AAAA,EACnD,QAAQ;AACN;AAAA,EACF;AACA,SAAO,gBAAgB,WAAW,MAAM;AAC1C;AACA,eAAe,mBAAmB,KAAK,QAAQ;AAC7C,QAAM,UAAU,MAAM,kBAAkB,KAAK,MAAM;AACnD,MAAI,SAAS;AACX,WAAO,SAAS,6BAA6B,OAAO;AAAA,EACtD;AACA,SAAO,YAAY,KAAK,MAAM;AAChC;AACA,eAAe,YAAY,KAAK,QAAQ;AACtC,QAAM,SAAS,IAAI,IAAI,IAAI,GAAG;AAC9B,QAAM,UAAU,OAAO,aAAa,IAAI,MAAM;AAC9C,QAAM,OAAO,OAAO,YAAY,YAAY,oBAAoB,KAAK,OAAO,IAAI,UAAU;AAC1F,QAAM,QAAQ,WAAW,UAAU,gBAAgB,IAAI,WAAW,EAAE,CAAC,CAAC;AACtE,QAAM,MAAM,IAAI,IAAI,0CAA0C;AAC9D,MAAI,aAAa,IAAI,aAAa,OAAO,QAAQ;AACjD,MAAI,aAAa,IAAI,gBAAgB,GAAG,OAAO,MAAM,sCAAsC;AAC3F,MAAI,SAAS,KAAK;AAChB,WAAO,SAAS,IAAI,SAAS,CAAC;AAAA,EAChC;AACA,MAAI,aAAa,IAAI,SAAS,KAAK;AACnC,SAAO,SAAS,IAAI,SAAS,GAAG,CAAC,CAAC,cAAqB,iBAAU,QAAQ,OAAO,MAAM;AAAA,IACpF,UAAU;AAAA,IACV,QAAQ;AAAA;AAAA,IAER,QAAQ,KAAK,KAAK;AAAA,IAClB,SAAS,IAAI,KAAK,KAAK,IAAI,IAAI,KAAK,KAAK,KAAK,GAAI;AAAA,IAClD,MAAM;AAAA,IACN,UAAU;AAAA,EACZ,CAAC,CAAC,CAAC,CAAC;AACN;AACA,eAAe,iBAAiB,KAAK,gBAAgB;AACnD,MAAI,OAAwC;AAC1C,WAAO;AAAA,MACL,QAAQ;AAAA,MACR,MAAM;AAAA,IACR;AAAA,EACF;AACA,SAAO,wBAAwB;AACjC;AACA,SAAS,0BAA0B,MAAM;AACvC,SAAc,iBAAU,MAAM,IAAI;AAAA,IAChC,QAAQ;AAAA,IACR,UAAU;AAAA,IACV,MAAM;AAAA,IACN,QAAQ;AAAA,IACR,SAAS,oBAAI,KAAK;AAAA,EACpB,CAAC;AACH;;;AC1WA,+BAA4B;AAE5B,SAAS,YAAY,SAAS;AAC5B,SAAO,eAAe,kBAAkB,SAAS;AAC/C,QAAI,iBAAiB,MAAM,kBAAkB,OAAO,sBAAsB,OAAO;AACjF,UAAM,gBAAgB,kBAAkB,QAAQ,YAAY,QAAQ,oBAAoB,WAAW,kBAAkB,gBAAgB,aAAa,QAAQ,oBAAoB,SAAS,SAAS,gBAAgB;AAChN,UAAM,UAAU,2BAA2B;AAAA,MACzC,GAAG;AAAA,MACH,WAAW,QAAQ,mBAAmB,QAAQ,cAAc,QAAQ,qBAAqB,SAAS,mBAAmB,iBAAiB,QAAQ,iBAAiB,SAAS,SAAS,aAAa,gCAAgC,QAAQ,SAAS,SAAS,OAAOK,gBAAe,MAAM;AAClR,eAAO,YAAY,IAAI;AAAA,MACzB,CAAC;AAAA,MACD,eAAe,SAAS,uBAAuB,QAAQ,kBAAkB,QAAQ,yBAAyB,SAAS,uBAAuB,iBAAiB,QAAQ,iBAAiB,SAAS,SAAS,aAAa,oCAAoC,QAAQ,UAAU,SAAS,QAAQA,gBAAe,MAAM;AAC7S,eAAO,YAAY,IAAI;AAAA,MACzB,CAAC;AAAA,MACD,SAAS,SAAS,iBAAiB,QAAQ,YAAY,QAAQ,mBAAmB,SAAS,iBAAiB,iBAAiB,QAAQ,iBAAiB,SAAS,SAAS,aAAa,sBAAsB,QAAQ,UAAU,SAAS,QAAQA,gBAAe,MAAM;AACjQ,eAAO,YAAY,IAAI;AAAA,MACzB,CAAC;AAAA,IACH,GAAG;AAAA,MACD,aAAa;AAAA,IACf,CAAC;AACD,UAAM;AAAA,MACJ;AAAA,MACA;AAAA,MACA;AAAA,IACF,IAAI,MAAM,QAAQ,QAAQ,OAAO;AAEjC,QAAI,+BAA+B,oBAAI,IAAI;AAC3C,QAAI,SAAS;AACX,UAAI,MAAM,QAAQ,OAAO,GAAG;AAC1B,mBAAW,CAAC,KAAK,KAAK,KAAK,SAAS;AAClC,cAAI,CAAC,6BAA6B,IAAI,IAAI,YAAY,CAAC,GAAG;AACxD,yCAA6B,IAAI,IAAI,YAAY,GAAG,CAAC,CAAC;AAAA,UACxD;AACA,uCAA6B,IAAI,IAAI,YAAY,CAAC,EAAE,KAAK,KAAK;AAAA,QAChE;AAAA,MACF,WAAW,OAAO,QAAQ,YAAY,YAAY;AAChD,mBAAW,CAAC,KAAK,KAAK,KAAK,QAAQ,QAAQ,GAAG;AAC5C,uCAA6B,IAAI,IAAI,YAAY,GAAG,CAAC,KAAK,CAAC;AAAA,QAC7D;AACA,YAAI,kBAAkB,WAAW,OAAO,QAAQ,iBAAiB,YAAY;AAC3E,gBAAMC,oBAAmB,QAAQ,aAAa;AAC9C,cAAIA,sBAAqB,QAAQA,sBAAqB,UAAUA,kBAAiB,QAAQ;AACvF,yCAA6B,IAAI,cAAcA,iBAAgB;AAAA,UACjE;AAAA,QACF;AAAA,MACF,OAAO;AACL,mBAAW,CAAC,KAAK,KAAK,KAAK,OAAO,QAAQ,OAAO,GAAG;AAClD,uCAA6B,IAAI,IAAI,YAAY,GAAG,CAAC,KAAK,CAAC;AAAA,QAC7D;AAAA,MACF;AAAA,IACF;AACA,UAAM,mBAAmB,6BAA6B,IAAI,YAAY;AACtE,iCAA6B,OAAO,YAAY;AAChD,QAAI,kBAAkB;AACpB,iBAAW,kBAAkB,kBAAkB;AAC7C,YAAI;AACJ,cAAM;AAAA,UACJ;AAAA,UACA;AAAA,UACA,GAAG;AAAA,QACL,QAAI,sCAAY,cAAc;AAC9B,cAAM,YAAY,oBAAoB,QAAQ,cAAc,QAAQ,sBAAsB,SAAS,SAAS,kBAAkB,YAAY;AAC1I,gBAAQ,QAAQ,IAAI,MAAM,OAAO;AAAA,UAC/B,QAAQ,QAAQ;AAAA,UAChB,SAAS,QAAQ;AAAA,UACjB,UAAU,QAAQ;AAAA,UAClB,QAAQ,QAAQ;AAAA,UAChB,MAAM,QAAQ;AAAA,UACd,UAAU,aAAa,SAAS,aAAa,YAAY,aAAa,SAAS,WAAW;AAAA,QAC5F,CAAC;AAAA,MACH;AAAA,IACF;AACA,WAAO,IAAI,SAAS,MAAM;AAAA,MACxB;AAAA,MACA,SAAS,CAAC,GAAG,6BAA6B,QAAQ,CAAC,EAAE,QAAQ,CAAC,CAAC,KAAK,GAAG,MAAM,IAAI,IAAI,OAAK,CAAC,KAAK,CAAC,CAAC,CAAC;AAAA,IACrG,CAAC;AAAA,EACH;AACF;AACA,SAASD,gBAAe,IAAI;AAC1B,MAAI;AACF,WAAO,GAAG;AAAA,EACZ,QAAQ;AACN,WAAO;AAAA,EACT;AACF;",
  "names": ["parseString", "cookie", "value", "parse", "cookies", "tryOrUndefined", "setCookieHeaders"]
}
