/* CSS Scroll-Driven Reveal Animations
 * Replaces JavaScript AOS library with native CSS animation-timeline: view()
 * Content is always visible by default; animations are progressive enhancement
 */

/* Keyframes */
@keyframes reveal-fade-up {
  from {
    opacity: 0;
    transform: translateY(2rem);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes reveal-fade-down {
  from {
    opacity: 0;
    transform: translateY(-2rem);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes reveal-fade-left {
  from {
    opacity: 0;
    transform: translateX(2rem);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

@keyframes reveal-fade-right {
  from {
    opacity: 0;
    transform: translateX(-2rem);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

@keyframes reveal-zoom-in {
  from {
    opacity: 0;
    transform: scale(0.9);
  }
  to {
    opacity: 1;
    transform: scale(1);
  }
}

@keyframes reveal-fade-in {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

/* Scroll-driven animations - progressive enhancement
 * Uses longhand properties to prevent CSS toolchain (Lightning CSS)
 * from merging animation + animation-timeline into a broken shorthand.
 * Gated behind body:not(.scroll-reveal-fallback) so JS can force the
 * IntersectionObserver path for browsers with buggy implementations (Firefox). */
@supports (animation-timeline: view()) {
  body:not(.scroll-reveal-fallback).use-animations [data-reveal="fade-up"] {
    animation-name: reveal-fade-up;
    animation-timing-function: linear;
    animation-fill-mode: both;
    animation-timeline: view();
    animation-range: entry 0% entry 35%;
  }

  body:not(.scroll-reveal-fallback).use-animations [data-reveal="fade-down"] {
    animation-name: reveal-fade-down;
    animation-timing-function: linear;
    animation-fill-mode: both;
    animation-timeline: view();
    animation-range: entry 0% entry 35%;
  }

  body:not(.scroll-reveal-fallback).use-animations [data-reveal="fade-left"] {
    animation-name: reveal-fade-left;
    animation-timing-function: linear;
    animation-fill-mode: both;
    animation-timeline: view();
    animation-range: entry 0% entry 35%;
  }

  body:not(.scroll-reveal-fallback).use-animations [data-reveal="fade-right"] {
    animation-name: reveal-fade-right;
    animation-timing-function: linear;
    animation-fill-mode: both;
    animation-timeline: view();
    animation-range: entry 0% entry 35%;
  }

  body:not(.scroll-reveal-fallback).use-animations [data-reveal="zoom-in"] {
    animation-name: reveal-zoom-in;
    animation-timing-function: linear;
    animation-fill-mode: both;
    animation-timeline: view();
    animation-range: entry 0% entry 35%;
  }

  body:not(.scroll-reveal-fallback).use-animations [data-reveal="fade-in"] {
    animation-name: reveal-fade-in;
    animation-timing-function: linear;
    animation-fill-mode: both;
    animation-timeline: view();
    animation-range: entry 0% entry 35%;
  }

  /* Stagger delays: shift animation-range forward by 3% per ordinal */
  body:not(.scroll-reveal-fallback).use-animations [data-reveal-delay="1"] { animation-range: entry 3% entry 38%; }
  body:not(.scroll-reveal-fallback).use-animations [data-reveal-delay="2"] { animation-range: entry 6% entry 41%; }
  body:not(.scroll-reveal-fallback).use-animations [data-reveal-delay="3"] { animation-range: entry 9% entry 44%; }
  body:not(.scroll-reveal-fallback).use-animations [data-reveal-delay="4"] { animation-range: entry 12% entry 47%; }
  body:not(.scroll-reveal-fallback).use-animations [data-reveal-delay="5"] { animation-range: entry 15% entry 50%; }
  body:not(.scroll-reveal-fallback).use-animations [data-reveal-delay="6"] { animation-range: entry 18% entry 53%; }
  body:not(.scroll-reveal-fallback).use-animations [data-reveal-delay="7"] { animation-range: entry 21% entry 56%; }
  body:not(.scroll-reveal-fallback).use-animations [data-reveal-delay="8"] { animation-range: entry 24% entry 59%; }
}

/* JS-driven fallback for Firefox and browsers with buggy scroll-driven animations.
 * JS adds .scroll-reveal-fallback to body, then IntersectionObserver adds .revealed
 * to each element as it enters the viewport. */
.scroll-reveal-fallback.use-animations [data-reveal] {
  opacity: 0;
  transition: opacity 0.6s ease, transform 0.6s ease;
}

.scroll-reveal-fallback.use-animations [data-reveal="fade-up"] { transform: translateY(2rem); }
.scroll-reveal-fallback.use-animations [data-reveal="fade-down"] { transform: translateY(-2rem); }
.scroll-reveal-fallback.use-animations [data-reveal="fade-left"] { transform: translateX(2rem); }
.scroll-reveal-fallback.use-animations [data-reveal="fade-right"] { transform: translateX(-2rem); }
.scroll-reveal-fallback.use-animations [data-reveal="zoom-in"] { transform: scale(0.9); }

.scroll-reveal-fallback.use-animations [data-reveal].revealed {
  opacity: 1;
  transform: none;
}

/* Stagger delays for fallback */
.scroll-reveal-fallback.use-animations [data-reveal-delay="1"] { transition-delay: 0.1s; }
.scroll-reveal-fallback.use-animations [data-reveal-delay="2"] { transition-delay: 0.2s; }
.scroll-reveal-fallback.use-animations [data-reveal-delay="3"] { transition-delay: 0.3s; }
.scroll-reveal-fallback.use-animations [data-reveal-delay="4"] { transition-delay: 0.4s; }
.scroll-reveal-fallback.use-animations [data-reveal-delay="5"] { transition-delay: 0.5s; }
.scroll-reveal-fallback.use-animations [data-reveal-delay="6"] { transition-delay: 0.6s; }
.scroll-reveal-fallback.use-animations [data-reveal-delay="7"] { transition-delay: 0.7s; }
.scroll-reveal-fallback.use-animations [data-reveal-delay="8"] { transition-delay: 0.8s; }

/* Reduced motion: disable all reveal animations */
@media (prefers-reduced-motion: reduce) {
  [data-reveal] {
    animation: none !important;
    transition: none !important;
    opacity: 1 !important;
    transform: none !important;
  }
}
