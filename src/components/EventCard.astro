---
import { Image } from 'astro:assets';
import type { Event } from '../data/events';

// Define strict typing for the component props
interface Props {
    event: Event;
}

// Destructure the event from props with type checking
const { event } = Astro.props;

// Helper function for date formatting
const formatEventDate = (date: Date): string => {
    return date.toLocaleDateString('en-US', {
        month: 'long',
        day: 'numeric',
    });
};

// Dynamic import of event icon with error handling
let eventIcon;
try {
    eventIcon = await import(`../images/events/${event.icon}`);
} catch (error) {
    console.error(`Failed to load icon for event: ${event.name}`);
    // You might want to provide a default/fallback icon here
}
---

<article class="flex items-center gap-4 p-4 rounded-lg border border-gray-200 hover:bg-gray-50 transition-colors">
    {/* Event Icon */}
    <div class="w-16 h-16 flex-shrink-0">
        {eventIcon && (
            <Image 
                src={eventIcon.default}
                alt={`${event.name} event icon`}
                width={64}
                height={64}
                class="rounded-lg object-contain"
            />
        )}
    </div>

    {/* Event Details */}
    <div class="flex-grow">
        <div class="flex items-center gap-2">
            <h3 class="text-lg font-semibold">
                <a 
                    href={event.url}
                    target="_blank"
                    rel="noopener noreferrer"
                    class="hover:text-blue-600"
                >
                    {event.name}
                </a>
            </h3>
            {event.isWorkshop && (
                <span class="px-2 py-1 text-xs font-medium bg-blue-100 text-blue-800 rounded-full">
                    Workshop
                </span>
            )}
        </div>
        <p class="text-gray-600">
            {formatEventDate(event.date)} â€¢ {event.city}, {event.country}
        </p>
        {event.presentationUrl && (
            <a 
                href={event.presentationUrl}
                class="text-sm text-blue-600 hover:text-blue-800 mt-1 inline-block"
                target="_blank"
                rel="noopener noreferrer"
            >
                View Presentation
            </a>
        )}
    </div>
</article>