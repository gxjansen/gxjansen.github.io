---
import Skeleton from "../Common/Skeleton.astro";
import ErrorBoundary from "../Common/ErrorBoundary.astro";

interface Props {
  episodeId: string;
  title: string;
}

const { episodeId, title } = Astro.props;
---

<ErrorBoundary fallback="Failed to load Spotify episode">
  <div class="relative h-[152px]">
    <Skeleton type="card" class="absolute inset-0" />
    <iframe
      id={`spotify-embed-${episodeId}`}
      class="absolute inset-0 h-full w-full rounded-lg"
      title={title}
      allow="encrypted-media"
      style="opacity: 0; transition: opacity 0.3s ease-in-out"
      onload="this.style.opacity = 1"></iframe>
    <div
      class="absolute inset-0 flex items-center justify-center rounded-lg bg-base-200"
      id={`spotify-load-button-${episodeId}`}
    >
      <button
        class="rounded bg-primary-500 px-4 py-2 text-white transition-colors hover:bg-primary-600"
        onclick="document.getElementById(`spotify-embed-${episodeId}`).src = `https://open.spotify.com/embed/episode/${episodeId}`; this.parentElement.style.display = 'none';"
      >
        Load Spotify Player
      </button>
    </div>
  </div>
</ErrorBoundary>
