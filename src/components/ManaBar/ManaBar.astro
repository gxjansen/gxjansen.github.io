---
interface Props {
  percent: number;
  time: string;
  depleted?: boolean;
  message?: string;
  memoryLow?: boolean;
  memoryCritical?: boolean;
}

const { percent, time, depleted = false, message, memoryLow = false, memoryCritical = false } = Astro.props;

// Generate progress bar: 10 characters total
const filled = Math.round(percent / 10);
const empty = 10 - filled;
const bar = '█'.repeat(filled) + '░'.repeat(empty);
---

<div class="mana-bar my-4 rounded-lg border border-base-700 bg-base-950 p-3 font-mono text-sm">
  <div class="flex flex-wrap gap-x-4 gap-y-1">
    <span class="whitespace-nowrap text-foam">{bar} {percent}%</span>
    <span class="whitespace-nowrap text-foam">⏱ {time}</span>
    {memoryLow && !memoryCritical && (
      <span class="whitespace-nowrap text-gold">⚠ MEMORY LOW</span>
    )}
    {memoryCritical && (
      <span class="whitespace-nowrap text-love animate-pulse">⚠ MEMORY CRITICAL</span>
    )}
  </div>
  {depleted && message && (
    <div class="mt-2 pt-2 border-t border-base-700 text-center">
      <div class="text-red-400 font-bold">SESSION MANA DEPLETED</div>
      <div class="text-base-400">{message}</div>
    </div>
  )}
</div>
