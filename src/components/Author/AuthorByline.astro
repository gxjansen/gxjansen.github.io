---
import { type CollectionEntry } from "astro:content";
import { Image } from "astro:assets";

interface Props {
  author: CollectionEntry<"authors">;
  showBio?: boolean;
  variant?: "compact" | "detailed";
}

const { author, showBio = true, variant = "compact" } = Astro.props;
const { name, avatar, bioShort, jobTitle, organization } = author.data;
const authorUrl = `/authors/${author.slug}`;
---

<div
  class="author-byline flex items-start gap-3"
  itemprop="author"
  itemscope
  itemtype="https://schema.org/Person"
>
  {avatar && (
    <a href={authorUrl} class="flex-shrink-0">
      <Image
        src={avatar}
        alt={`${name}'s avatar`}
        width={variant === "compact" ? 48 : 64}
        height={variant === "compact" ? 48 : 64}
        quality="high"
        loading="eager"
        class={`rounded-full object-cover ${variant === "compact" ? "h-12 w-12" : "h-16 w-16"}`}
        itemprop="image"
      />
    </a>
  )}

  <div class="flex-1">
    <div class="flex items-baseline gap-2 flex-wrap">
      <a
        href={authorUrl}
        class="font-semibold text-base-900 dark:text-base-100 hover:text-primary-500 dark:hover:text-primary-400"
        itemprop="url"
      >
        <span itemprop="name">{name}</span>
      </a>
      {jobTitle && (
        <span class="text-sm text-base-600 dark:text-base-400" itemprop="jobTitle">
          {jobTitle}
        </span>
      )}
    </div>

    {organization && (
      <div class="text-sm text-base-600 dark:text-base-400" itemprop="worksFor" itemscope itemtype="https://schema.org/Organization">
        <span itemprop="name">{organization}</span>
      </div>
    )}

    {showBio && bioShort && (
      <p class="mt-1 text-sm text-base-700 dark:text-base-300" itemprop="description">
        {bioShort}
      </p>
    )}
  </div>
</div>
