---
interface Props {
  src: string;
  title: string;
  coverImage?: string;
}

const { src, title, coverImage } = Astro.props;
---

<div
  class="audio-player w-full rounded-xl bg-base-200 p-4 transition-colors dark:bg-base-800"
>
  {
    coverImage && (
      <div class="cover-image mb-3">
        <img
          src={coverImage}
          alt={`${title} podcast cover`}
          class="aspect-square w-full rounded-lg object-cover"
          loading="lazy"
          decoding="async"
        />
      </div>
    )
  }
  <audio controls preload="metadata" class="h-10 w-full" title={title}>
    <source src={src} type="audio/mpeg" />
    <p>
      Your browser doesn't support HTML5 audio.
      <a
        href={src}
        download
        class="text-primary-600 underline dark:text-primary-400"
        >Download the audio</a
      >
    </p>
  </audio>
</div>

<style>
  /* Custom styling for the audio player */
  .audio-player audio {
    width: 100%;
    border-radius: 0.5rem;
  }

  /* Webkit browsers (Chrome, Safari, Edge) */
  .audio-player audio::-webkit-media-controls-panel {
    background: linear-gradient(to right, #f2e9e1, #dfdad3);
  }

  :global(.dark) .audio-player audio::-webkit-media-controls-panel {
    background: linear-gradient(to right, #393552, #26233a);
  }

  .audio-player audio::-webkit-media-controls-current-time-display,
  .audio-player audio::-webkit-media-controls-time-remaining-display {
    color: #393552;
  }

  :global(.dark)
    .audio-player
    audio::-webkit-media-controls-current-time-display,
  :global(.dark)
    .audio-player
    audio::-webkit-media-controls-time-remaining-display {
    color: #e0def4;
  }

  /* Focus styles for accessibility */
  .audio-player audio:focus {
    outline: 2px solid #31748f;
    outline-offset: 2px;
  }

  .audio-player audio:focus-visible {
    outline: 2px solid #31748f;
    outline-offset: 2px;
  }
</style>
