---
import { formatDate } from '@utils/pressUtils';
import type { PressCoverage } from '@types/press';

interface Props {
  awards: PressCoverage[];
}

const { awards } = Astro.props;

// Brand icon mapping based on organization
const getBrandIcon = (org: string | undefined): string | null => {
  if (!org) return null;
  const orgLower = org.toLowerCase();

  if (orgLower.includes('elevenlabs') || orgLower.includes('n8n')) return 'elevenlabs';
  if (orgLower.includes('adobe') || orgLower.includes('magento')) return 'adobe';
  if (orgLower.includes('ebay')) return 'ebay';
  if (orgLower.includes('experimentation culture')) return 'experiment';
  if (orgLower.includes('digital elite')) return 'trophy';
  if (orgLower.includes('community manager') || orgLower.includes('mycmgr')) return 'community';

  return null;
};
---

<section
  id="awards"
  class="mb-16"
  aria-labelledby="awards-heading"
>
  <h2
    id="awards-heading"
    class="h2 mb-4"
  >
    Awards & Nominations
  </h2>
  <div
    class="grid gap-4 md:grid-cols-2"
    role="list"
    aria-label="List of awards and nominations"
  >
    {awards.map(award => {
      const formattedDate = formatDate(award.publicationDate);
      const awardId = `award-${award.articleUrl ? new URL(award.articleUrl).pathname.replace(/\W/g, '-') : crypto.randomUUID()}`;
      const isNomination = award.category === 'nomination';
      const brandIcon = getBrandIcon(award.personOrganization);

      return (
        <article
          class={`award-card rounded-xl p-6 hover:shadow-lg transition-shadow ${
            isNomination
              ? 'bg-gradient-to-br from-base-50 to-base-100 dark:from-base-800/50 dark:to-base-700/50 border border-base-200 dark:border-base-600'
              : 'bg-gradient-to-br from-primary-50 to-primary-100 dark:from-primary-900/20 dark:to-primary-800/20 border border-primary-200 dark:border-primary-700'
          }`}
          role="listitem"
          aria-labelledby={awardId}
        >
          <div class="flex items-start gap-4">
            <div class={`flex-shrink-0 w-12 h-12 rounded-lg flex items-center justify-center ${
              isNomination
                ? 'bg-base-200 dark:bg-base-700'
                : 'bg-base-100 dark:bg-base-800 border border-base-200 dark:border-base-600'
            }`}>
              {brandIcon === 'elevenlabs' ? (
                <svg class="w-8 h-8" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                  <path d="M7 4h2v16H7V4zm8 0h2v16h-2V4z" class="text-base-900 dark:text-base-100"/>
                </svg>
              ) : brandIcon === 'adobe' ? (
                <svg class="w-8 h-8" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                  <path d="M13.966 22.624l-1.69-4.281H8.122l3.892-9.144 5.662 13.425h-3.71zm-6.09-16.776L1 22.624h3.748l1.778-4.543h3.648L7.876 5.848zM15.867 5.848L22.999 22.624h-3.748l-1.778-4.543h-3.648l2.042-12.233z" class="text-[#FF0000]"/>
                </svg>
              ) : brandIcon === 'ebay' ? (
                <svg class="w-8 h-8" viewBox="0 0 24 24" aria-hidden="true">
                  <text x="2" y="17" font-size="10" font-weight="bold" font-family="system-ui">
                    <tspan fill="#E53238">e</tspan><tspan fill="#0064D2">b</tspan><tspan fill="#F5AF02">a</tspan><tspan fill="#86B817">y</tspan>
                  </text>
                </svg>
              ) : brandIcon === 'experiment' ? (
                <svg class="w-7 h-7 text-base-700 dark:text-base-300" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" aria-hidden="true">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M9.75 3.104v5.714a2.25 2.25 0 01-.659 1.591L5 14.5M9.75 3.104c-.251.023-.501.05-.75.082m.75-.082a24.301 24.301 0 014.5 0m0 0v5.714c0 .597.237 1.17.659 1.591L19.8 15.3M14.25 3.104c.251.023.501.05.75.082M19.8 15.3l-1.57.393A9.065 9.065 0 0112 15a9.065 9.065 0 00-6.23.693L5 14.5m14.8.8l1.402 1.402c1.232 1.232.65 3.318-1.067 3.611l-2.395.41a9.045 9.045 0 01-3.55-.092L12 20.5l-2.19.131a9.045 9.045 0 01-3.55.092l-2.395-.41c-1.717-.293-2.3-2.379-1.067-3.611L5 14.5" />
                </svg>
              ) : brandIcon === 'trophy' ? (
                <svg class="w-7 h-7 text-base-700 dark:text-base-300" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" aria-hidden="true">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M16.5 18.75h-9m9 0a3 3 0 013 3h-15a3 3 0 013-3m9 0v-3.375c0-.621-.503-1.125-1.125-1.125h-.871M7.5 18.75v-3.375c0-.621.504-1.125 1.125-1.125h.872m5.007 0H9.497m5.007 0a7.454 7.454 0 01-.982-3.172M9.497 14.25a7.454 7.454 0 00.981-3.172M5.25 4.236c-.982.143-1.954.317-2.916.52A6.003 6.003 0 007.73 9.728M5.25 4.236V4.5c0 2.108.966 3.99 2.48 5.228M5.25 4.236V2.721C7.456 2.41 9.71 2.25 12 2.25c2.291 0 4.545.16 6.75.47v1.516M18.75 4.236c.982.143 1.954.317 2.916.52A6.003 6.003 0 0116.27 9.728M18.75 4.236V4.5c0 2.108-.966 3.99-2.48 5.228m2.48-5.492a46.32 46.32 0 012.916.52 6.003 6.003 0 01-5.395 4.972m0 0a7.454 7.454 0 01-.982 3.172M9.497 14.25a7.454 7.454 0 00.981 3.172" />
                </svg>
              ) : brandIcon === 'community' ? (
                <svg class="w-7 h-7 text-base-700 dark:text-base-300" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" aria-hidden="true">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M18 18.72a9.094 9.094 0 003.741-.479 3 3 0 00-4.682-2.72m.94 3.198l.001.031c0 .225-.012.447-.037.666A11.944 11.944 0 0112 21c-2.17 0-4.207-.576-5.963-1.584A6.062 6.062 0 016 18.719m12 0a5.971 5.971 0 00-.941-3.197m0 0A5.995 5.995 0 0012 12.75a5.995 5.995 0 00-5.058 2.772m0 0a3 3 0 00-4.681 2.72 8.986 8.986 0 003.74.477m.94-3.197a5.971 5.971 0 00-.94 3.197M15 6.75a3 3 0 11-6 0 3 3 0 016 0zm6 3a2.25 2.25 0 11-4.5 0 2.25 2.25 0 014.5 0zm-13.5 0a2.25 2.25 0 11-4.5 0 2.25 2.25 0 014.5 0z" />
                </svg>
              ) : (
                <svg class="w-7 h-7 text-base-700 dark:text-base-300" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" aria-hidden="true">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M11.48 3.499a.562.562 0 011.04 0l2.125 5.111a.563.563 0 00.475.345l5.518.442c.499.04.701.663.321.988l-4.204 3.602a.563.563 0 00-.182.557l1.285 5.385a.562.562 0 01-.84.61l-4.725-2.885a.563.563 0 00-.586 0L6.982 20.54a.562.562 0 01-.84-.61l1.285-5.386a.562.562 0 00-.182-.557l-4.204-3.602a.563.563 0 01.321-.988l5.518-.442a.563.563 0 00.475-.345L11.48 3.5z" />
                </svg>
              )}
            </div>
            <div class="flex-1 min-w-0">
              <h3
                id={awardId}
                class="text-lg font-semibold text-base-900 dark:text-base-100 mb-2"
              >
                {award.title}
              </h3>
              <div
                class="text-sm text-base-600 dark:text-base-400 flex flex-wrap items-center gap-2"
                aria-label={isNomination ? "Nomination details" : "Award details"}
              >
                <time datetime={new Date(award.publicationDate).toISOString()}>
                  <span class="sr-only">{isNomination ? "Nominated in " : "Received on "}</span>
                  {formattedDate}
                </time>
                {award.personOrganization && (
                  <>
                    <span aria-hidden="true">•</span>
                    <span>
                      <span class="sr-only">{isNomination ? "Nominated by " : "Awarded by "}</span>
                      {award.personOrganization}
                    </span>
                  </>
                )}
              </div>
              {award.articleUrl && (
                <a
                  href={award.articleUrl}
                  target="_blank"
                  rel="noopener noreferrer"
                  class="inline-flex items-center gap-1 mt-3 text-primary-600 dark:text-primary-400 hover:text-primary-700 dark:hover:text-primary-300 font-medium text-sm"
                  aria-label={`View details about ${award.title} (opens in new tab)`}
                  title={`View details about ${award.title}`}
                >
                  View details <span aria-hidden="true">→</span>
                </a>
              )}
            </div>
          </div>
        </article>
      );
    })}
  </div>
</section>
