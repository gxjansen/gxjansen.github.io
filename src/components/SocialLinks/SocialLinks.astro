---
// Import the social links configuration
import { socialLinks } from "@data/socialLinks";
import SocialIcon from "@components/SocialIcon/SocialIcon.astro";

interface Props {
  class?: string;
  location?: "footer" | "hero" | "contact" | "about";
  context?: "footer" | "hero";
}

const {
  class: className,
  location = "footer",
  context = location,
} = Astro.props;

// Explicitly filter links based on context
const visibleLinks = socialLinks.filter((link) => {
  // Use context for filtering, with a fallback to location
  return link.visibility[context] === true;
});
---

<nav
  class:list={["relative", className]}
  role="navigation"
  aria-label="Social media links"
>
  <ul
    class:list={[
      "pointer-events-auto flex items-center gap-2 overflow-x-auto whitespace-nowrap sm:gap-3 md:gap-4 [&::-webkit-scrollbar]:hidden",
      context === "footer" ? "pr-6" : "px-4 sm:px-0",
    ]}
    role="list"
  >
    {
      visibleLinks.map(({ name, href, icon }) => (
        <li role="listitem" class="group relative pt-8">
          <div class="pointer-events-none absolute left-1/2 top-0 z-[100] -translate-x-1/2 opacity-0 transition-opacity duration-200 group-hover:opacity-100 [.group:first-child_&]:left-0 [.group:first-child_&]:translate-x-0 [.group:last-child_&]:left-auto [.group:last-child_&]:right-0 [.group:last-child_&]:translate-x-0">
            <div class="mb-6 whitespace-nowrap rounded-md border border-base-700/20 bg-base-900/90 px-2.5 py-1.5 text-xs text-base-50 shadow-lg backdrop-blur-sm">
              {name}
              <div class="absolute left-1/2 top-full -mt-px -translate-x-1/2 border-4 border-transparent border-t-base-900/90" />
            </div>
          </div>
          <SocialIcon
            href={href}
            icon={icon}
            social={name}
            class:list={[
              "transition-transform hover:scale-110",
              context === "footer"
                ? "h-6 w-6 sm:h-6 sm:w-6"
                : "h-6 w-6 sm:h-7 sm:w-7 md:h-8 md:w-8",
            ]}
          />
        </li>
      ))
    }
  </ul>
</nav>
